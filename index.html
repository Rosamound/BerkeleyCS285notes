<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Assignment 1: Imitation Learning</title>
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script id="MathJax-script" async
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
</script>
<style>
    body {
        font-family: "Times New Roman", Times, serif;
        line-height: 1.6;
        margin: 40px;
        background-color: #f9f9f9;
        color: #333;
    }
    h1, h2, h3 {
        color: #2c3e50;
    }
    h1 {
        text-align: center;
        margin-bottom: 50px;
    }
    img {
        display: block;
        margin: 20px auto;
        max-width: 80%;
    }
    .definition {
        background-color: #f0f0f0;
        padding: 10px 15px;
        border-left: 5px solid #3498db;
        margin: 15px 0;
    }
    p {
        text-indent: 2em;
    }
    .formula {
        text-align: center;
        margin: 15px 0;
        font-size: 1.1em;
    }
</style>
</head>
<body>

<h1>Assignment 1: Imitation Learning</h1>

<img src="assignment1-1.png" alt="Assignment Image">

<h2>Understanding</h2>
<div class="definition">
<p><strong>Definition:</strong> <code>p_π(s_t)</code> denotes the state distribution of state <code>s</code> at time <code>t</code> after executing policy <code>π</code>.</p>
</div>

<h2>Proof</h2>

<p>If from time 1 to t, the learned policy gives the same output as the expert policy, then the state distribution <code>p_{π_θ}(s_t)</code> at time t is the same as <code>p_{π^*}(s_t)</code>.</p>

<p>Let <code>E_i</code> denote the event at time step <code>i</code> that <code>π_θ ≠ π^*</code>. Then we have:</p>

<div class="formula">
\[
\Pr\Big[\bigcup_{i=1}^{t-1} E_i\Big] \le \sum_{i=1}^{t-1} \Pr[E_i] \le (t-1) \varepsilon
\]
</div>

<p>From the relationship between Total Variation Distance (TVD) and L1 error, for two random distributions:</p>

<div class="formula">
\[
D_{TV}(P,Q) = \frac{1}{2}\sum_s |P(s) - Q(s)|, \quad D_{TV}(P,Q) \le \Pr\Big[\bigcup E\Big]
\]
</div>

<p>So we obtain:</p>

<div class="formula">
\[
\sum_s |p_{π_θ}(s_t)-p_{π^*}(s_t)| \le 2\Pr\Big[\bigcup_{i=1}^{t-1} E_i\Big].
\]
</div>

<p>Summing over t = 1 to T gives:</p>

<div class="formula">
\[
\sum_{t=1}^T \sum_s |p_{π_θ}(s_t)-p_{π^*}(s_t)| 
\le 2\sum_{t=1}^T \sum_{i=1}^{t-1} \Pr[E_i] 
= 2\sum_{i=1}^{T-1} (T-i)\Pr[E_i] \le 2T\varepsilon
\]
</div>

</body>
</html>
